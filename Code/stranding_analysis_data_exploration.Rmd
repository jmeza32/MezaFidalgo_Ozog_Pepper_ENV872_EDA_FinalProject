---
title: "Data Exploration"
author: "Joshua Meza-Fidalgo, Jess Ozog & Britney Pepper"
date: '2022-04-02'
output: pdf_document
---

```{r Setup}
library(dplyr)
library(ggplot2)
library(tidyverse)

getwd()

mytheme <- theme_bw() +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "right")
theme_set(mytheme)
```


```{r Data Prep}
Stranding_Data <- read.csv("../Data/Processed/strandings_final.csv", stringsAsFactors = TRUE)

Stranding_Data <- Stranding_Data %>%
  select(Family:longitude)
```


```{r Data Exploration}
class(Stranding_Data)

str(Stranding_Data)

colnames(Stranding_Data)

dim(Stranding_Data)

length(Stranding_Data)
```

```{r Data Exploration}
head(Stranding_Data)

tail(Stranding_Data)
```

```{r Data Summary}
summary(Stranding_Data)
```

```{r Visually Exploring Data}
ggplot(Stranding_Data) +
  geom_bar(aes(x = Family, fill = Family)) +
  ylab("Count") +
  labs(title = "Total Strandings per Family")

ggplot(Stranding_Data) +
  geom_bar(aes(x = Year, fill = Family)) +
  ylab("Count") +
  labs(title = "Total Strandings per Year")

ggplot(Stranding_Data) +
  geom_bar(aes(x = Month, fill = Family)) +
  ylab("Count") +
  labs(title = "Total Strandings per Month") +scale_x_discrete(name = "Month",
                   limits = c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))
```
```{r Annual Data Development}
# this code creates a new data frame of the year and number of strandings that year
Annual_Strandings_Sum <- Stranding_Data %>%
  group_by(Year) %>%
  summarise(Sum = n())

# now try to add columns to that data frame of the breakdown of the totals of each group
Annual_Strandings_Turtles <- Stranding_Data %>%
  filter(Family == "Turtles") %>%
  group_by(Year) %>%
  summarise(Turtles_Total = n())

Annual_Strandings_Pinniped <- Stranding_Data %>%
  filter(Family == "Pinnipeds") %>%
  group_by(Year) %>%
  summarise(Pinnipeds_Total = n())

Annual_Strandings_Odontocetes <- Stranding_Data %>%
  filter(Family == "Odontocetes") %>%
  group_by(Year) %>%
  summarise(Odontocetes_Total = n())


Annual_Strandings_Mysticetes <- Stranding_Data %>%
  filter(Family == "Mysticetes") %>%
  group_by(Year) %>%
  summarise(Mysticetes_Total = n()) %>%
  add_row(Year = 1994, Mysticetes_Total=0)



Annual_Strandings_Totals <- cbind(Annual_Strandings_Sum, Annual_Strandings_Turtles[,2], Annual_Strandings_Pinniped[,2], Annual_Strandings_Mysticetes[,2], Annual_Strandings_Odontocetes[,2])

write.csv(Annual_Strandings_Totals, row.names = TRUE, file = "../Data/Processed/annual_strandings_totals.csv")

```


```{r Monthly Data Development}
Monthly_Strandings_Sum <- Stranding_Data %>%
  group_by(Month) %>%
  summarise(Sum = n())

Monthly_Strandings_Turtles <- Stranding_Data %>%
  filter(Family == "Turtles") %>%
  group_by(Month) %>%
  summarise(Turtles_Total = n()) %>%
  add_row(Month = 1, Turtles_Total=0) %>%
  add_row(Month = 10, Turtles_Total=0)


Monthly_Strandings_Pinniped <- Stranding_Data %>%
  filter(Family == "Pinnipeds") %>%
  group_by(Month) %>%
  summarise(Pinnipeds_Total = n())

Monthly_Strandings_Odontocetes <- Stranding_Data %>%
  filter(Family == "Odontocetes") %>%
  group_by(Month) %>%
  summarise(Odontocetes_Total = n())


Monthly_Strandings_Mysticetes <- Stranding_Data %>%
  filter(Family == "Mysticetes") %>%
  group_by(Month) %>%
  summarise(Mysticetes_Total = n()) %>%
  add_row(Month = 1, Mysticetes_Total=0) %>%
  add_row(Month = 10, Mysticetes_Total=0)


Monthly_Strandings_Totals <- cbind(Monthly_Strandings_Sum, Monthly_Strandings_Turtles[,2], Monthly_Strandings_Pinniped[,2], Monthly_Strandings_Mysticetes[,2], Monthly_Strandings_Odontocetes[,2])

write.csv(Monthly_Strandings_Totals, row.names = TRUE, file = "../Data/Processed/monthly_strandings_totals.csv")
```



```{r Geospatial Exploration}
Strandings_sf <- Stranding_Data %>%
  st_as_sf(coords = c("longitude", "latitude"), crs = 4326)

mapview(Strandings_sf, zcol = "Family")
```